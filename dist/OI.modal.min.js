/* OI-Modals v0.9.2 
 * Copyright (c) 2015 Opportunity International 
 */
!function(a){a.fn.modal=function(c){return this.each(function(){new b(a(this),c)})},a.modal=function(a){new b(null,a).open()};var b=function(b,c){function d(){var a;return a=e()?f()?"video":"url":g()?"content":"dynamic"}function e(){return/^https?:\/\//.test(c.source)}function f(){return/^https?:\/\/(www\.youtube|player\.vimeo)/.test(c.source)}function g(){return a(c.source).length>0?!0:!1}function h(){o&&(o.find(".modal-container").outerHeight()>=a(window).height()?o.addClass("overflow"):o.removeClass("overflow"))}function i(){var b=window.innerWidth;if(!b){var c=document.documentElement.getBoundingClientRect();b=c.right-Math.abs(c.left)}var d=b-a("body").width();a("#content").css("padding-right",d);var e=o.find(".close.fixed");e.length>0&&e.css("right",d)}function j(){a("#content").css("padding-right","");var b=o.find(".close.fixed");b.length>0&&b.css("right","")}function k(){i(),r=a(window).scrollTop(),a("body").addClass("no-scroll"),a("#content").css("top",-r)}function l(){setTimeout(function(){j(),a("body").removeClass("no-scroll"),a(window).scrollTop(r),a("#content").css("top",0)},500)}function m(){if(o){var a=o.find(".modal-container");o.hasClass("overflow")?a.css("margin-top",""):a.css("margin-top",-a.height()/2)}}function n(){o.css("z-index",c.zIndex)}var o,p=this,q=a(b),r=0;c=a.extend({classes:q.data("modal-classes")||null,source:q.data("modal")||null,content:null,type:q.data("modal-type")||null,zIndex:3,beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}},c),"function"==typeof c.content&&(c.content=c.content.call(q)),this.type=c.type||d(),this.setElement=function(){var b;switch(p.type){case"video":b=a("<div>",{"class":"flex-video"}),b.append(a("<iframe>",{src:q.data("modal"),frameborder:0})),c.content=b,o=p.createElement();break;case"url":b=a("<div>",{"class":"iframe"}),b.append(a("<iframe>",{src:q.data("modal"),frameborder:0})),c.content=b,o=p.createElement();break;case"content":o=a(c.source);break;case"dynamic":o=p.createElement()}o.data("modal",p)},this.createElement=function(){var b=a("<div>",{"class":"modal"});return b.append(a("<div>",{"class":"modal-container"})),b.find(".modal-container").append(a("<button>",{type:"button","class":"reset icon-cross close"})),b.find(".modal-container").append(a("<div>",{"class":"modal-content"})),c.classes&&b.find(".modal-container").addClass(c.classes),b.find(".modal-content").append(c.content),a("body").append(b),b.data("destroyOnClose",!0),b},this.open=function(){return p.setElement(),c.beforeOpen.call(o,p)===!1?!1:(Modernizr.rgba||o.prepend(a("<div>",{"class":"ie8-overlay"})),k(),n(),o.addClass("animate"),setTimeout(function(){h(),o.addClass("show"),Modernizr.csstransforms||m()},100),o.find(".close").bind("click.modal",function(){p.close()}),o.bind("click.modal",function(){p.close()}),o.find(".modal-container").bind("click.modal",function(a){a.stopPropagation()}),a(document).bind("keyup.modal",function(a){"27"==a.keyCode&&p.close()}),setTimeout(function(){c.afterOpen.call(o,p)},600),!1)},this.close=function(){return c.beforeClose.call(o,p)===!1?!1:(l(),o.find(".close").unbind("click.modal"),a("#modals").unbind("click.modal"),o.unbind("click.modal"),a(document).unbind("keyup.modal"),o.removeClass("show"),void setTimeout(function(){o.removeClass("animate"),h(),Modernizr.rgba||o.find(".ie8-overlay").remove(),c.afterClose.call(o,p),o.data("destroyOnClose")&&o.remove()},500))},q.click(function(){return p.open(),!1}),a(window).resize(function(){h(),Modernizr.csstransforms||m()})};window.Modal=b}(jQuery);