/* OI-Modals v0.9.8 
 * Copyright (c) 2015 Opportunity International 
 */
!function(a){a.lightbox=function(a,c){return new b(a,c)};var b=function(b,c){function d(b){var c="function"==typeof i.options.aboveContent?i.options.aboveContent.call(b,j.index(b),j):i.options.aboveContent,d="function"==typeof i.options.belowContent?i.options.belowContent.call(b,j.index(b),j):i.options.belowContent,e=a("<div>",{"class":"lightbox-image"}),f=a("<img>",{src:b.attr("href"),"class":"block"});m=a("<button>",{type:"button","class":"reset lightbox-next icon-arrow-right-small"}),l=a("<button>",{type:"button","class":"reset lightbox-prev icon-arrow-left-small"}),j.index(b)>0&&e.append(l),e.append(f),j.index(b)<j.length-1&&e.append(m),l.on("click.lightbox",function(){i.prev()}),m.on("click.lightbox",function(){i.next()});var g=a("<div>",{"class":"lightbox-container"}).append(a(c),e,a(d));return g}function e(b,c){var d=new Image;d.src=b,a(d).on("load",function(){"function"==typeof c&&c.call()})}function f(){i.modal.element.addClass("size");var b=i.modal.element.find(".modal-container"),c=b.find(".lightbox-image img");b.css("max-width","");var d=b.outerHeight(),e=c.outerHeight(),f=c.prop("naturalWidth"),g=c.outerWidth()/e,h=a(window).height()-40;if(d>h){var j=(h-(d-e))*g;b.css("max-width",Math.min(j,f)+"px")}else b.css("max-width",f+"px");i.modal.element.removeClass("size")}function g(){var c=a(this).attr("rel");return k=a(this),j=a(b+(c?'[rel="'+c+'"]':"")),e(k.attr("href"),function(){i.modal=new Modal(null,{content:d(k,j),classes:"lightbox",afterClose:h}).create(),f(),i.modal.open(),a(document).bind("keyup.lightbox",function(a){39===a.keyCode?i.next():37===a.keyCode&&i.prev()})}),!1}function h(){j=null,k=null,l.off("click.lightbox"),m.off("click.lightbox"),l=null,m=null,i.modal=null,a(document).unbind("keyup.lightbox")}var i=this,j=null,k=null,l=null,m=null;this.trigger=a(b),this.modal=null,this.options=a.extend({aboveContent:"",belowContent:""},c),this.next=function(){var a=j.index(k);a<j.length-1&&(k=j.eq(a+1),e(k.attr("href"),function(){i.modal.update(d(k),f)}))},this.prev=function(){var a=j.index(k);a>0&&(k=j.eq(a-1),e(k.attr("href"),function(){i.modal.update(d(k),f)}))},this.trigger.click(g),a(window).on("resize.lightbox",function(){i.modal&&f()})};window.Lightbox=b}(jQuery);